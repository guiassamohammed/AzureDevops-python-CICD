# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- master

stages:
- stage: build
  jobs:
  - job: build 
    pool:
      vmImage:  ubuntu-latest
    
    steps: 
     - task: UsePythonVersion@0
       displayName: python version
       inputs:
         versionSpec: '3.x'
         addToPath: true
         architecture: 'x64'

      
     - script: |
        python -m venv antenv
        source antenv/bin/activate
        python -m pip install --upgrade pip
        pip install setup
        find -name "requirements.txt"
        pip install -r requirements.txt
       workingDirectory: $(Build.ArtifactStagingDirectory)
       displayName: "Install requirements"

     - task: ArchiveFiles@2
       displayName: archive the build
       inputs:
             rootFolderOrFile: '$(Build.ArtifactStagingDirectory)'
             includeRootFolder: true
             archiveType: 'zip'
             archiveFile: '$(Build.ArtifactStagingDirectory)/$(Build.BuildId).zip'
             replaceExistingArchive: true
            
     - task: PublishBuildArtifacts@1
       displayName:  publish the file
       inputs:
            PathtoPublish: '$(Build.ArtifactStagingDirectory)'
            ArtifactName: 'drop'
            publishLocation: 'Container'
            

